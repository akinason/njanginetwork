{% extends 'base_dashboard.html' %}
{% load static i18n humanize njangi_tags staticfiles mptt_tags %}

{% block content %}
<div class="forms">
    <div class="form-grids row widget-shadow" data-example-id="basic-forms">
        <div class="form-title">
            {% if top_node.user == user %}
                <h4>{% trans 'My Network'|title %} | {{ protocol }}{{ site_info.website }}/signup/?rid={{ top_node.user.sponsor_id }}</h4>
            {% else %}
                <h4>{% trans 'My Network'|title %} | {{ protocol }}{{ site_info.website }}/signup/?rid={{ top_node.user.sponsor_id }}&pid={{ user.sponsor_id }}</h4>
            {% endif %}
        </div>
        <div class="form-body">
            <link rel="stylesheet" media="screen, projection" href="{% static 'mptt_graph/tree.css' %}" />
            <div class="text-center">
                <div class="text-left" style="display:inline-block">
                    <div class="tree">
                        <ul>
                        {% recursetree nodes %}
                            <li>
                                <h6>
                                <a href="{% url 'mptt_graph:network_graph' user_id=node.user.id %}">
                                    {{ node.user.username }} | 
                                    {{ node.side }} |<br> 
                                    {% if top_node.user.level < node.user.level %} 
                                        <span style="color:rgb(0,255,0)">{% trans 'Lvl' %} {{ node.user.level }}</span> 
                                    {% elif node.user.level == 0 %} 
                                        <span style="color:rgb(255,0,0)">{% trans 'Lvl' %} {{ node.user.level }}</span>
                                    {% else %}
                                        <span style="color:rgb(0,0,255)">{% trans 'Lvl' %} {{ node.user.level }}</span>
                                    {% endif %} |
                                    {{ node.get_descendant_count }}
                                </a></h6>
                                {% if not node.is_leaf_node %}
                                    <ul>
                                        {{ children }}
                                    </ul>
                                {% endif %}
                            </li>
                        {% endrecursetree %}
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--</div>-->
{% endblock %}